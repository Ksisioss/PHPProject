{% extends 'base.html.twig' %}

{% block body %}
    <section class="event-list-section aspad">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section-title">
                        <h2>Upcoming Grand Prix</h2>
                    </div>
                </div>
            </div>
            <div class="row mb-4">
                <div class="col-lg-12">
                    <form id="filter-form">
                        <div class="form-row">
                            <div class="col">
                                <input type="text" id="name-filter" class="form-control" placeholder="Search a Grand Prix">
                            </div>
                            <div class="col">
                                <input type="date" id="date-filter" class="form-control">
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="schedule-tab">
                        <div class="tab-content">
                            {% for date, eventsOnDate in groupedEvents %}
                                {% for event in eventsOnDate %}
                                    <div class="st-content event-card" data-title="{{ event.title }}" data-date="{{ event.date|date('Y-m-d') }}">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col-lg-3">
                                                    <div class="sc-pic">
                                                        <img src="{{ asset('img/schedule/schedule-1.jpg') }}" alt="">
                                                    </div>
                                                </div>
                                                <div class="col-lg-5">
                                                    <div class="sc-text">
                                                        <h4>{{ event.title }}</h4>
                                                        <h6>{{ event.description }}</h6>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4">
                                                    <ul class="sc-widget">
                                                        <li><i class="fa fa-clock-o"></i> {{ event.date|date('F j, Y, g:i a') }}</li>
                                                        <li><i class="fa fa-map-marker"></i> {{ event.location }}, {{ event.country }}</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const nameFilter = document.getElementById('name-filter');
            const dateFilter = document.getElementById('date-filter');
            const eventCards = document.querySelectorAll('.event-card');

            nameFilter.addEventListener('input', filterEvents);
            dateFilter.addEventListener('input', filterEvents);

            function filterEvents() {
                const nameValue = nameFilter.value.toLowerCase();
                const dateValue = dateFilter.value;

                eventCards.forEach(card => {
                    const title = card.getAttribute('data-title').toLowerCase();
                    const date = card.getAttribute('data-date');

                    const matchesName = title.includes(nameValue);
                    const matchesDate = date === dateValue || dateValue === '';

                    if (matchesName && matchesDate) {
                        card.style.display = 'block'; // or ''
                    } else {
                        card.style.display = 'none';
                    }
                });
            }
        });
    </script>
{% endblock %}
